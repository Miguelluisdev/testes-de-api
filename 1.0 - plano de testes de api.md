## Plano de Testes de API

### 1. Objetivo

O plano de testes de API tem por objetivo garantir que todas as interfaces de programação (APIs) de um sistema ou serviço:

* funcionem conforme especificado (funcionalidade);
* sejam seguras contra acessos indevidos ou vulnerabilidades;
* atendam requisitos de desempenho e confiabilidade;
* se integrem corretamente com outros sistemas ou componentes;
* tenham uma boa experiência de uso para clientes consumidores (internos ou externos).

### 2. Escopo

Abrange todos os endpoints da API, incluindo:

* Métodos HTTP (GET, POST, PUT, DELETE, etc.);
* Parâmetros de entrada (requeridos e opcionais);
* Respostas esperadas, códigos de status (200, 404, 500 etc.);
* Formatos de resposta (JSON, XML, etc.);
* Autenticação e autorização;
* Workflow ou cadeia de chamadas (quando um fluxo envolve múltiplos endpoints);
* Performance sob carga e situações de pico;
* Segurança (injeção de dados, controle de acesso, criptografia, etc.).

### 3. Tipos de Testes

Conforme boas práticas, o plano deve contemplar vários tipos de teste, cada um com sua finalidade:

| Tipo de Teste                                 | Finalidade / Exemplos                                                                                                             |
| --------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| **Unitário**                                  | Verificar unidades isoladas (ex: um endpoint) — se ele trata parâmetros corretamente, retorna erros esperados em casos inválidos. |
| **Integrado**                                 | Verificar integração entre APIs ou APIs + base de dados + outros serviços.                                                        |
| **Funcional**                                 | Confirmar que a API faz exatamente o que foi especificado: todos os requisitos de negócio, regras de validação, etc.              |
| **Contrato (Contract Testing)**               | Garantir que o consumidor e o fornecedor da API tenham um contrato claro — formato de request/resposta, schemas, SLAs.            |
| **End-to-End**                                | Testar fluxos de uso que atravessam vários endpoints, simulando casos reais de uso de ponta a ponta.                              |
| **Performance / Load Testing**                | Simular carga, testar tempos de resposta, verificar o que acontece sob pico de uso.                                               |
| **Segurança**                                 | Testar autenticação, autorização, exposição de dados sensíveis, injeção de SQL, XSS, etc.                                         |
| **Testes de compatibilidade / versionamento** | Verificar se versões novas da API mantêm compatibilidade, se clientes antigos continuam funcionando.                              |

### 4. Ambientes de Teste

* Ambiente dedicado que espelhe o ambiente de produção o mais próximo possível (hardware, configurações, dependências).
* Uso de dados fictícios / mockados quando necessário, especialmente para dados sensíveis.
* Variáveis de ambiente para separar endpoints, credenciais, etc.

### 5. Ferramentas e Automação

* Escolher uma ferramenta ou plataforma de testes de API (Ex: Postman, SoapUI, Insomnia, ferramentas específicas de performance, etc.).
* Automação de execuções: integração com pipelines CI/CD, execuções programadas, monitoramento contínuo.
* Uso de trechos de testes reutilizáveis (scripts comuns, validações comuns) para reduzir duplicação.
* Gestão de variáveis e parametrização para tornar os testes mais flexíveis.

### 6. Organização dos Testes

* Testes devem estar bem organizados (por endpoint, por recurso, ou por funcionalidade).
* Separação clara entre testes unitários, integrados e end-to-end.
* Uso de tags ou categorias para permitir execução seletiva (ex.: todos os de segurança, todos os de carga, etc.).
* Manutenção contínua: remover testes desatualizados, ajustar conforme a API evolui.

### 7. Métricas e Critérios de Aceitação

Definir critérios claros para considerar um teste ou conjunto de testes como aprovado:

* Cobertura mínima de endpoints / funcionalidades.
* Tempo de resposta aceitável (por exemplo, < 200 ms para requests comuns, < 1 s para operações mais pesadas).
* Percentual de erro tolerado (porcentagem de requisições com status 5xx ou falha).
* Segurança: nenhuma vulnerabilidade crítica, conformidade com políticas de segurança.
* Recursos consumidos: sobrecarga, memória, latência, etc.

### 8. Cronograma

* Quando cada tipo de teste será realizado (unitários enquanto desenvolve, integração logo após, performance antes de lançamentos, etc.).
* Pontos de decisão: quando uma API está pronta para entrar em produção (critério de aceitação).
* Responsáveis por cada fase de teste.

### 9. Riscos e Mitigações

* Riscos de discrepância entre ambiente de teste e produção (dados, infraestrutura).
* Possibilidade de dados sensíveis vazarem, ou ambiente de teste acessando erroneamente produção.
* Complexidade em manter testes atualizados se a API evolui rápido.
* Mitigação: ambiente mock, uso de versão de API, comunicação entre times, automação de testes.

### 10. Relatórios e Monitoramento

* Documentar resultados de cada execução de teste: quais passaram, quais falharam, tempo de resposta, etc.
* Análise de tendências: se erros estão aumentando, latência piorando, etc.
* Integração com alertas: se um teste crítico falhar em produção (monitoramento), disparar alertas.
* Feedback contínuo para times de desenvolvimento.
